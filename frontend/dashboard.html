<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Panel de Gestión</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Estilos personalizados del Dashboard -->
    <link rel="stylesheet" href="css/dashboard-styles-vista.css">
    
    <!-- Configuración de Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: { 850: '#1e293b', 900: '#0f172a' },
                        primary: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>

<body class="text-slate-800">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        
        <!-- Header -->
        <div class="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4 animate-fade-in-up">
            <div>
                <h1 class="text-3xl font-bold text-slate-900 tracking-tight">Panel de Control</h1>
                <p class="text-slate-500 mt-1">Visión general del cronograma y rendimiento de objetivos.</p>
            </div>
            <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm text-sm">
                <span class="relative flex h-3 w-3">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                </span>
                <span class="text-slate-600">Actualizado:</span>
                <span class="font-mono font-medium text-slate-800" id="ultimaActualizacion">--:--</span>
                <button id="btnRecargar" class="ml-2 text-blue-600 hover:text-blue-800" title="Recargar">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>

        <!-- Tarjetas de Estadísticas -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            
            <!-- Total Objetivos -->
            <div class="stat-card blue animate-fade-in-up" style="animation-delay: 0.05s">
                <div class="stat-content">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm font-medium text-slate-500 uppercase tracking-wider">Total Objetivos</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-1" id="totalObjetivos">0</h3>
                        </div>
                        <div class="stat-icon-wrapper blue">
                            <i class="fas fa-bullseye"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600 font-medium flex items-center">
                            <i class="fas fa-arrow-up mr-1"></i> <span id="porcentajeCompletado">0%</span>
                        </span>
                        <span class="text-slate-400 ml-2">completados</span>
                    </div>
                </div>
            </div>

            <!-- Completados -->
            <div class="stat-card green animate-fade-in-up" style="animation-delay: 0.1s">
                <div class="stat-content">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm font-medium text-slate-500 uppercase tracking-wider">Completados</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-1" id="objetivosCompletados">0</h3>
                        </div>
                        <div class="stat-icon-wrapper green">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="w-full bg-slate-100 rounded-full h-1.5 mt-4">
                        <div class="bg-green-500 h-1.5 rounded-full" id="barraCompletados" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- En Proceso -->
            <div class="stat-card blue animate-fade-in-up" style="animation-delay: 0.15s">
                <div class="stat-content">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm font-medium text-slate-500 uppercase tracking-wider">En Proceso</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-1" id="enProceso">0</h3>
                        </div>
                        <div class="stat-icon-wrapper blue">
                            <i class="fas fa-spinner fa-spin-pulse" style="--fa-animation-duration: 3s;"></i>
                        </div>
                    </div>
                    <div class="w-full bg-slate-100 rounded-full h-1.5 mt-4">
                        <div class="bg-blue-500 h-1.5 rounded-full" id="barraProceso" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Pendientes -->
            <div class="stat-card yellow animate-fade-in-up" style="animation-delay: 0.2s">
                <div class="stat-content">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm font-medium text-slate-500 uppercase tracking-wider">Pendientes</p>
                            <h3 class="text-3xl font-bold text-slate-800 mt-1" id="pendientes">0</h3>
                        </div>
                        <div class="stat-icon-wrapper yellow">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                    <div class="w-full bg-slate-100 rounded-full h-1.5 mt-4">
                        <div class="bg-amber-400 h-1.5 rounded-full" id="barraPendientes" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráficos -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            
            <!-- Estado General -->
            <div class="chart-container animate-fade-in-up lg:col-span-1">
                <h3 class="text-lg font-bold text-slate-800 mb-6">Estado General</h3>
                <div class="flex flex-col items-center justify-center h-64">
                    <div class="relative">
                        <svg class="progress-ring" width="160" height="160">
                            <circle class="text-slate-100" stroke="currentColor" stroke-width="12" fill="transparent" r="70" cx="80" cy="80" />
                            <circle id="progressCircle" class="progress-ring-circle text-blue-600" stroke="currentColor" stroke-width="12" fill="transparent" r="70" cx="80" cy="80" stroke-dasharray="440" stroke-dashoffset="440" stroke-linecap="round" />
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-3xl font-bold text-slate-800" id="progressPercent">0%</span>
                            <span class="text-xs text-slate-500 uppercase font-semibold">Progreso</span>
                        </div>
                    </div>
                    <div class="flex justify-center gap-4 mt-6 w-full text-xs">
                        <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-green-500 mr-2"></span>Listo</div>
                        <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-blue-500 mr-2"></span>Proceso</div>
                        <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-amber-400 mr-2"></span>Pendiente</div>
                    </div>
                </div>
            </div>

            <!-- Tareas Activas -->
            <div class="chart-container animate-fade-in-up lg:col-span-2">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold text-slate-800">Tareas Activas Recientes</h3>
                    <a href="#" id="btnVerTodoTareas" class="text-sm text-blue-600 hover:text-blue-800 font-medium transition">Ver todo</a>
                </div>
                <div class="overflow-y-auto custom-scroll" style="max-height: 280px;" id="listaTareasRecientes">
                    <div class="flex flex-col items-center justify-center h-40 text-slate-400">
                        <i class="fas fa-circle-notch fa-spin text-2xl mb-2"></i>
                        <p class="mt-2 text-sm">Cargando tareas...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cronograma de Actividades (Gantt) -->
        <div class="gantt-container animate-fade-in-up mb-8">
            <div class="gantt-header-panel">
                <div>
                    <h3 class="text-lg font-bold text-slate-800 flex items-center gap-2">
                        <i class="fas fa-layer-group text-blue-600"></i> Cronograma de Actividades
                    </h3>
                    <p class="text-sm text-slate-500">Visualización temporal de objetivos y sus tareas</p>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <div class="flex items-center gap-2">
                         <input type="date" id="ganttFechaInicio" class="text-xs border border-slate-300 rounded px-2 py-1.5 bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                         <span class="text-slate-400">-</span>
                         <input type="date" id="ganttFechaFin" class="text-xs border border-slate-300 rounded px-2 py-1.5 bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                         <button id="btnFiltrar" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded text-xs font-medium transition">
                            <i class="fas fa-filter mr-1"></i> Filtrar
                         </button>
                    </div>
                </div>
            </div>

            <div id="ganttVisualizacion">
                <div id="ganttContentWrapper" class="min-w-full">
                     <div class="flex flex-col items-center justify-center h-40 text-slate-400">
                        <i class="fas fa-chart-gantt text-3xl mb-2 opacity-50"></i>
                        <p>Generando diagrama...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config/control-objetivos.config.js"></script>
    <script src="js/services/control-objetivos.service.js"></script>
    <script src="js/controllers/dashboard.controller.js"></script>
</body>
</html>

